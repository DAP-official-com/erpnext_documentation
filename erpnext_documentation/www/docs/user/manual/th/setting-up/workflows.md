<!-- add-breadcrumbs -->
# เวิร์กโฟลว์

**ด้วยเวิร์กโฟลว์ คุณสามารถเขียนใหม่ว่ากระบวนการ/เวิร์กโฟลว์นั้นได้รับการอนุมัติใน ERPNext อย่างไร**

คุณสามารถตั้งค่าการอนุมัติได้หลายระดับสำหรับเวิร์กโฟลว์ ERPNext ในการอนุญาตให้บุคคลหลายคนส่งคำขอหลายรายการ สำหรับการอนุมัติโดยผู้ใช้หลายคน ERPNext ต้องการให้คุณกรอกเงื่อนไขเวิร์กโฟลว์ ERPNext ติดตามการอนุญาตหลายรายการก่อนส่ง

พิจารณาสถานการณ์สมมติที่ต้องการการอนุมัติหลายระดับสำหรับใบเสนอราคา พนักงานขาย (ผู้ใช้ที่มีบทบาท 'Sales User') จะสร้างใบเสนอราคา จากนั้นจะได้รับการอนุมัติหรือปฏิเสธโดยลูกค้าเป้าหมาย (ผู้ใช้ที่มีบทบาท 'ผู้จัดการฝ่ายขาย') หากได้รับการอนุมัติจากหัวหน้าฝ่ายขาย ก็จะได้รับการอนุมัติเพิ่มเติมหรือปฏิเสธโดยผู้จัดการระดับภูมิภาค (ผู้ใช้ที่มีบทบาท 'ผู้จัดการระดับภูมิภาค')

ในการสร้างกฎเวิร์กโฟลว์และการเปลี่ยนแปลง ไปที่:

> Home > Settings > Workflow

<img class="screenshot" alt="Workflow" src="{{docs_base_url}}/assets/img/setup/workflow-leave-fl.png">

นี่คือตัวอย่างการอนุมัติแบบสองระดับพร้อมการยกเลิก หากผู้ใช้ขอลา คำขอจะถูกส่งไปยังแผนกทรัพยากรบุคคล ฝ่ายทรัพยากรบุคคล (ผู้ใช้ทรัพยากรบุคคล) จะปฏิเสธหรืออนุมัติคำขอนี้ เมื่อกระบวนการนี้เสร็จสิ้น ผู้จัดการของผู้ใช้ (ผู้อนุมัติการลา) จะได้รับข้อบ่งชี้ว่าแผนกทรัพยากรบุคคลได้ยอมรับหรือปฏิเสธ ผู้จัดการซึ่งเป็นผู้มีอำนาจอนุมัติจะอนุมัติหรือปฏิเสธคำขอนี้ ดังนั้น ผู้ใช้จะได้รับสถานะอนุมัติหรือถูกปฏิเสธ


เมื่อขั้นตอนการทำงานจะถูกสร้างขึ้นคุณสามารถดำเนินการกับมันผ่าน [การดำเนินการขั้นตอนการทำงาน](/docs/user/manual/th/setting-up/workflow-actions).

## 1. ข้อกำหนดเบื้องต้น
ก่อนสร้างเวิร์กโฟลว์ ขอแนะนำให้สร้างสิ่งเหล่านี้ก่อน:

* [การดำเนินการเวิร์กโฟลว์](/docs/user/manual/th/setting-up/workflow-actions)
* สถานะเวิร์กโฟลว์ เช่น อนุมัติ ยกเลิก ฯลฯ

## 2. วิธีสร้างเวิร์กโฟลว์
1. ไปที่รายการเวิร์กโฟลว์ คลิกที่ใหม่
1. ป้อนชื่อสำหรับ**เวิร์กโฟลว์**และเลือกเอกสาร (DocType) ที่จะใช้
1. ป้อนสถานะต่างๆ ของเวิร์กโฟลว์ ป้อนสถานะเอกสารสำหรับพวกเขา เลือกฟิลด์ที่จะอัปเดตจากคอลัมน์ อัปเดตฟิลด์ ป้อนค่าที่จะอัปเดตภายใต้ อัปเดตค่า

สถานะเวิร์กโฟลว์สามารถมีสีต่างกันไปตามสถานะ เช่น สีเขียวเพื่อความสำเร็จ สถานะเอกสาร: บันทึกแล้ว = 0, ส่งแล้ว = 1, ยกเลิก = 2

    <img class="screenshot" alt="Workflow" src="{{docs_base_url}}/assets/img/setup/workflow-1.png">

    ฟิลด์ที่คุณเลือกภายใต้ Update Field จะได้รับการอัปเดตสำหรับประเภทเอกสารเมื่อสถานะเปลี่ยนแปลง Update Value คือข้อความที่ปรากฏบนฟิลด์ที่เลือกใน Update Field ดังนั้นที่นี่ ฟิลด์สถานะจะได้รับการอัปเดตเป็น ใช้แล้ว อนุมัติแล้ว ฯลฯ

1. ป้อนกฎการเปลี่ยน

    <img class="screenshot" alt="Workflow" src="{{docs_base_url}}/assets/img/setup/workflow-2.png">

    การดำเนินการบ่งชี้ถึงการดำเนินการที่ผู้อนุมัติสามารถทำได้ในใบสมัครลา สถานะถัดไปคือสถานะที่จะใช้กับประเภทเอกสารเมื่อมีการใช้การดำเนินการ ดังนั้นในที่นี้ สถานะจะเปลี่ยนจากใช้แล้วเป็นอนุมัติโดย HR เมื่อดำเนินการอนุมัติ

1. ภายใต้ ฟิลด์สถานะเวิร์กโฟลว์ ให้ป้อนชื่อสำหรับฟิลด์ที่กำหนดเองที่จะเพิ่มลงในเอกสาร (DocType), ระบบการลา
1. เมื่อบันทึก ระบบจะสร้างฟิลด์ที่กำหนดเองใน DocType

### 2.2 สิ่งที่ควรทราบเมื่อสร้างเวิร์กโฟลว์

* การสร้างเวิร์กโฟลว์ใน ERPNext จะแทนที่เวิร์กโฟลว์บันทึกและส่งปกติ ดังนั้น เอกสารจะทำงานตามเวิร์กโฟลว์ของคุณ และไม่อิงตามเวิร์กโฟลว์โค้ดที่กำหนดไว้ล่วงหน้า ดังนั้นอาจไม่มีปุ่ม/ตัวเลือกส่ง หากคุณไม่ได้ระบุไว้ในเวิร์กโฟลว์ที่คุณสร้างขึ้น

    หากคุณไม่ได้ใช้เวิร์กโฟลว์กับเอกสาร และเอกสารนั้นสามารถส่งได้ เวิร์กโฟลว์นั้นจะมีเวิร์กโฟลว์เริ่มต้นพร้อมสถานะ: แบบร่าง - ส่งแล้ว - ยกเลิกแล้ว หากคุณกำลังใช้เวิร์กโฟลว์กับเอกสารที่ส่งได้ ผู้ใช้ควรจัดการสถานะเริ่มต้นเหล่านั้น

* เอกสารไม่สามารถยกเลิกได้เว้นแต่จะส่ง

* หากคุณต้องการให้ตัวเลือกในการยกเลิก คุณจะต้องเขียนขั้นตอนการเปลี่ยนเวิร์กโฟลว์ที่ระบุว่าจากการส่งแล้ว เป็นคุณสามารถยกเลิกได้

* หากไม่มีการอัปเดตฟิลด์ภายใต้คอลัมน์ ฟิลด์อัปเดต ระบบจะสร้างฟิลด์ที่กำหนดเองใหม่โดยใช้ชื่อที่คุณตั้งไว้ในฟิลด์ 'ฟิลด์สถานะเวิร์กโฟลว์'

### 2.3 ตัวเลือกอื่นๆ สำหรับเวิร์กโฟลว์
1. **ทำงานอยู่:** เมื่อเลือกตัวเลือกนี้ เวิร์กโฟลว์อื่นๆ ทั้งหมดสำหรับ DocType ที่เลือกจะไม่ทำงาน
1. **ห้ามแทนที่สถานะ:** สถานะของเวิร์กโฟลว์นี้จะไม่แทนที่สถานะของเอกสาร (ใบเสนอราคา) ในมุมมองรายการ
1. **ส่งการแจ้งเตือนทางอีเมล:** อีเมลจะถูกส่งไปยังผู้ใช้พร้อมกับการดำเนินการเวิร์กโฟลว์ที่เป็นไปได้ในครั้งต่อไป

## 3. คุณสมบัติ

### 3.1 เปิด/ปิดสถานะเวิร์กโฟลว์เสริม

> Introduced in Version 12

สถานะเวิร์กโฟลว์ที่ไม่บังคับหมายความว่าอาจไม่เป็นส่วนหนึ่งของการอนุมัติขั้นสุดท้าย เช่น สถานะเช่น ยกเลิก หรือ ปฏิเสธ สามารถเลือกได้

![Optional State](/docs/assets/img/setup/workflow-optional-state.png)

**หมายเหตุ:** การดำเนินการเวิร์กโฟลว์จะไม่ถูกสร้างขึ้นสำหรับสถานะทางเลือก (Optional State)

### 3.2 เงื่อนไข

> Introduced in Version 11

คุณยังสามารถเพิ่มเงื่อนไขสำหรับการเปลี่ยนให้ใช้ได้ ตัวอย่างเช่น ในกรณีนี้ หากผู้บริหารฝ่ายขายสร้างใบเสนอราคาที่มียอดรวมตั้งแต่ 100,000 ดอลลาร์ขึ้นไป บทบาทเฉพาะจะต้องอนุมัติ เพื่อให้สิ่งนี้เกิดขึ้นในการเปลี่ยนแปลงโดยเฉพาะ คุณสามารถตั้งค่าคุณสมบัติสำหรับ **Condition :**

```
doc.grand_total <= 100000
```

grand_totalคือชื่อฟิลด์ของฟิลด์ 'ผลรวมทั้งหมด' ของใบเสนอราคา หากต้องการดูชื่อฟิลด์ของฟิลด์ ให้ไปที่เมนู > ปรับแต่ง

สามารถขยายไปยังคุณสมบัติใดๆ ของเอกสารได้

> Introduced in Version 13

ในเวอร์ชัน 13 คุณสามารถใช้วันที่/เวลา เซสชัน รับค่า และรับฟังก์ชันรายการในนิพจน์เงื่อนไขของคุณ

ฟังก์ชั่นที่อนุญาต:

* frappe.db.get_value
* frappe.db.get_list
* frappe.session
* frappe.utils.now_datetime
* frappe.utils.get_datetime
* frappe.utils.add_to_date
* frappe.utils.now

ตัวอย่าง:

```
doc.creation > frappe.utils.add_to_date(frappe.utils.now_datetime(), days=-5, as_string=True, as_datetime=True) 
```

## 4. ตัวอย่างขั้นตอนการขอลางาน

เมื่อพนักงานบันทึกใบสมัครลา สถานะของเอกสารจะเปลี่ยนเป็น "ส่งแล้ว":

<img class="screenshot" alt="Workflow" src="{{docs_base_url}}/assets/img/setup/workflow-3.png">

เมื่อพนักงานฝ่ายทรัพยากรบุคคลเข้าสู่ระบบ เขาสามารถอนุมัติหรือปฏิเสธ หากได้รับอนุมัติ สถานะของเอกสารจะเปลี่ยนเป็น "อนุมัติโดยฝ่ายทรัพยากรบุคคล" อย่างไรก็ตาม ยังไม่ได้รับการอนุมัติจาก "ผู้อนุมัติการลา"

<img class="screenshot" alt="Workflow" src="{{docs_base_url}}/assets/img/setup/workflow-4.png">

เมื่อ "ผู้อนุมัติการลา" เปิดเพจระบบการลาแล้ว เขาก็สามารถ "อนุมัติ" หรือ "ปฏิเสธ" บนระบบการลา

<img class="screenshot" alt="Workflow" src="{{docs_base_url}}/assets/img/setup/workflow-5.png">

## 5. วิดีโอ
<div>
    <div class="embed-container">
        <iframe src="https://www.youtube.com/embed/yObJUg9FxFs?rel=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
        </iframe>
    </div>
</div>

### 6. หัวข้อที่เกี่ยวข้อง
1. [การดำเนินการเวิร์กโฟลว์](/docs/user/manual/th/setting-up/workflow-actions)
1. [กฎการมอบหมาย](/docs/user/manual/th/automation/assignment-rule)
